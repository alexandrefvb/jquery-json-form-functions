$.fn.toJson=function(){function a(b,c,e){if(1===c.length){var f=c[0].match(d),g=f?f[1]:c[0];b[g]?f?b[g].push(e):b[g]=e:b[g]=f?[e]:e}else{b[c[0]]||(b[c[0]]={});var h=b[c[0]];c.splice(0,1),a(h,c,e)}}function b(a){if("string"==typeof a)return a;if($.isArray(a))for(var d in a)a[d]=b(a[d]);else for(var e in a){var f=e.match(c);f?(a[f[1]]=a[f[1]]||[],a[f[1]][parseInt(f[2])]=b(a[e]),delete a[e]):a[e]=b(a[e])}return a}var c=/(.+)\[(\d+)\]/,d=/(.+)\[\]/,e={},f=this.serializeArray();for(var g in f)if(""!==f[g].value){var h=f[g].name.split(" ").join("").split(".");a(e,h,f[g].value)}return e=b(e)},$.fn.postJson=function(){var a=$.ajax({type:"POST",url:this.attr("action")||window.location.href,data:JSON.stringify(this.toJson()),dataType:"json",processData:!1,contentType:"application/json; charset=UTF-8"});return a},$.fn.putJson=function(){var a=$.ajax({type:"PUT",url:this.attr("action")||window.location.href,data:JSON.stringify(this.toJson()),dataType:"json",processData:!1,contentType:"application/json; charset=UTF-8"});return a};